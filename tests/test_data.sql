/*
 * NL2SQL 測試資料與測試案例
 * 
 * 用途：
 * 1. 建立測試用的資料表和資料
 * 2. 定義 NL2SQL 的測試案例（自然語言 → 預期 SQL → 預期結果）
 */

-- ============================================
-- PART 1: 建立測試資料表
-- ============================================

-- 刪除舊表並重建
DROP TABLE IF EXISTS [Employees];
GO

CREATE TABLE [Employees] (
    [EmployeeID] INT IDENTITY(1,1) PRIMARY KEY,
    [Name] NVARCHAR(100) NOT NULL,
    [Email] NVARCHAR(200),           -- 字串，可能 NULL 或空白
    [Phone] NVARCHAR(50),            -- 字串，可能 NULL 或空白
    [Department] NVARCHAR(100),      -- 字串，可能 NULL 或空白
    [Notes] NVARCHAR(500),           -- 字串，可能 NULL 或空白
    [Salary] DECIMAL(10,2),          -- 數字，可能 NULL
    [BirthDate] DATE,                -- 日期，可能 NULL
    [HireDate] DATE,                 -- 日期，可能 NULL
    [IsActive] BIT,                  -- 布林，可能 NULL
    [PerformanceScore] INT           -- 整數，可能 NULL
);
GO

-- ============================================
-- PART 2: 插入測試資料
-- ============================================

INSERT INTO [Employees] 
([Name], [Email], [Phone], [Department], [Notes], [Salary], [BirthDate], [HireDate], [IsActive], [PerformanceScore])
VALUES 
    -- 完整資料
    (N'張三', N'zhangsan@example.com', N'0912-345-678', N'工程部', N'資深工程師', 80000.00, '1990-05-15', '2018-03-01', 1, 95),
    (N'李四', N'lisi@example.com', N'0923-456-789', N'行銷部', N'負責社群行銷', 65000.00, '1992-08-20', '2019-06-15', 1, 88),
    
    -- 字串欄位 NULL vs 空白
    (N'王五', NULL, N'0934-567-890', N'人資部', N'負責招募', 70000.00, '1988-12-10', '2017-01-10', 1, 90),
    (N'趙六', N'', N'0945-678-901', N'財務部', N'會計主管', 75000.00, '1985-03-25', '2015-09-01', 1, 92),
    
    -- 數字欄位 NULL
    (N'陳七', N'chen7@example.com', NULL, N'工程部', N'前端工程師', NULL, '1995-07-08', '2021-02-20', 1, 85),
    (N'林八', N'lin8@example.com', N'', N'行銷部', N'活動企劃', 55000.00, NULL, '2020-04-01', 1, NULL),
    
    -- 日期欄位 NULL
    (N'周九', N'zhou9@example.com', N'0967-890-123', N'業務部', NULL, 60000.00, '1991-11-30', NULL, 1, 78),
    (N'吳十', N'wu10@example.com', N'0978-901-234', N'業務部', N'', 58000.00, NULL, '2022-01-15', NULL, 80),
    
    -- 布林欄位 NULL + 多重空值
    (N'鄭十一', N'', NULL, N'', N'測試多重空值', NULL, NULL, '2023-06-01', NULL, NULL),
    (N'黃十二', NULL, N'', NULL, NULL, 50000.00, '1998-02-14', '2023-08-15', 0, NULL);
GO

-- 驗證資料
SELECT * FROM [Employees];
GO


-- ============================================
-- PART 3: 測試案例
-- ============================================

/*
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ 測試案例 1: 字串欄位空值檢查 (NULL vs 空白字串)                                           │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│ 自然語言：找出有填 Email 的員工                                                          │
│                                                                                         │
│ 預期 SQL：                                                                              │
│   SELECT * FROM [Employees]                                                             │
│   WHERE [Email] IS NOT NULL AND [Email] <> ''                                           │
│                                                                                         │
│ 預期結果：應排除 王五(NULL)、趙六('')、鄭十一('')、黃十二(NULL)                            │
│ 預期筆數：6 筆 (張三, 李四, 陳七, 林八, 周九, 吳十)                                        │
└─────────────────────────────────────────────────────────────────────────────────────────┘
*/

-- 測試 1 驗證查詢
SELECT [Name], [Email] 
FROM [Employees] 
WHERE [Email] IS NOT NULL AND [Email] <> '';
-- 預期：張三, 李四, 陳七, 林八, 周九, 吳十

/*
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ 測試案例 2: 字串欄位空值檢查 (Phone)                                                      │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│ 自然語言：找出電話號碼不是空的員工                                                        │
│                                                                                         │
│ 預期 SQL：                                                                              │
│   SELECT * FROM [Employees]                                                             │
│   WHERE [Phone] IS NOT NULL AND [Phone] <> ''                                           │
│                                                                                         │
│ 預期結果：應排除 陳七(NULL)、林八('')、鄭十一(NULL)、黃十二('')                            │
│ 預期筆數：6 筆 (張三, 李四, 王五, 趙六, 周九, 吳十)                                        │
└─────────────────────────────────────────────────────────────────────────────────────────┘
*/

-- 測試 2 驗證查詢
SELECT [Name], [Phone] 
FROM [Employees] 
WHERE [Phone] IS NOT NULL AND [Phone] <> '';
-- 預期：張三, 李四, 王五, 趙六, 周九, 吳十

/*
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ 測試案例 3: 數字欄位 NULL 檢查                                                           │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│ 自然語言：列出有薪水資料的員工                                                           │
│                                                                                         │
│ 預期 SQL：                                                                              │
│   SELECT * FROM [Employees]                                                             │
│   WHERE [Salary] IS NOT NULL                                                            │
│                                                                                         │
│ 預期結果：應排除 陳七(NULL)、鄭十一(NULL)                                                 │
│ 預期筆數：8 筆                                                                           │
└─────────────────────────────────────────────────────────────────────────────────────────┘
*/

-- 測試 3 驗證查詢
SELECT [Name], [Salary] 
FROM [Employees] 
WHERE [Salary] IS NOT NULL;
-- 預期：8 筆

/*
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ 測試案例 4: 日期欄位 NULL 檢查                                                           │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│ 自然語言：找出有生日紀錄的員工                                                           │
│                                                                                         │
│ 預期 SQL：                                                                              │
│   SELECT * FROM [Employees]                                                             │
│   WHERE [BirthDate] IS NOT NULL                                                         │
│                                                                                         │
│ 預期結果：應排除 林八(NULL)、吳十(NULL)、鄭十一(NULL)                                     │
│ 預期筆數：7 筆                                                                           │
└─────────────────────────────────────────────────────────────────────────────────────────┘
*/

-- 測試 4 驗證查詢
SELECT [Name], [BirthDate] 
FROM [Employees] 
WHERE [BirthDate] IS NOT NULL;
-- 預期：7 筆

/*
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ 測試案例 5: 布林欄位檢查                                                                 │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│ 自然語言：找出目前在職的員工                                                             │
│                                                                                         │
│ 預期 SQL：                                                                              │
│   SELECT * FROM [Employees]                                                             │
│   WHERE [IsActive] = 1                                                                  │
│                                                                                         │
│ 預期結果：IsActive = 1 的員工                                                            │
│ 預期筆數：7 筆 (排除 黃十二(0)、吳十(NULL)、鄭十一(NULL))                                  │
└─────────────────────────────────────────────────────────────────────────────────────────┘
*/

-- 測試 5 驗證查詢
SELECT [Name], [IsActive] 
FROM [Employees] 
WHERE [IsActive] = 1;
-- 預期：7 筆

/*
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ 測試案例 6: 查詢 NULL 值                                                                 │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│ 自然語言：列出績效分數為空的員工                                                          │
│                                                                                         │
│ 預期 SQL：                                                                              │
│   SELECT * FROM [Employees]                                                             │
│   WHERE [PerformanceScore] IS NULL                                                      │
│                                                                                         │
│ 預期結果：PerformanceScore 為 NULL 的員工                                                │
│ 預期筆數：4 筆 (林八, 鄭十一, 黃十二)                                                     │
└─────────────────────────────────────────────────────────────────────────────────────────┘
*/

-- 測試 6 驗證查詢
SELECT [Name], [PerformanceScore] 
FROM [Employees] 
WHERE [PerformanceScore] IS NULL;
-- 預期：林八, 鄭十一, 黃十二

/*
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ 測試案例 7: 複合條件查詢                                                                 │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│ 自然語言：找出工程部且薪水超過 6 萬的員工                                                 │
│                                                                                         │
│ 預期 SQL：                                                                              │
│   SELECT * FROM [Employees]                                                             │
│   WHERE [Department] = N'工程部' AND [Salary] > 60000                                   │
│                                                                                         │
│ 預期結果：工程部且薪水 > 60000                                                           │
│ 預期筆數：1 筆 (張三)                                                                    │
└─────────────────────────────────────────────────────────────────────────────────────────┘
*/

-- 測試 7 驗證查詢
SELECT [Name], [Department], [Salary] 
FROM [Employees] 
WHERE [Department] = N'工程部' AND [Salary] > 60000;
-- 預期：張三

/*
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ 測試案例 8: 備註欄位空字串 vs NULL                                                        │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│ 自然語言：找出有備註的員工                                                               │
│                                                                                         │
│ 預期 SQL：                                                                              │
│   SELECT * FROM [Employees]                                                             │
│   WHERE [Notes] IS NOT NULL AND [Notes] <> ''                                           │
│                                                                                         │
│ 預期結果：Notes 有內容的員工                                                             │
│ 預期筆數：7 筆 (排除 周九(NULL)、吳十('')、黃十二(NULL))                                   │
└─────────────────────────────────────────────────────────────────────────────────────────┘
*/

-- 測試 8 驗證查詢
SELECT [Name], [Notes] 
FROM [Employees] 
WHERE [Notes] IS NOT NULL AND [Notes] <> '';
-- 預期：7 筆
